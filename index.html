<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solana Quiz (Test)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #0D0D2B 0%, #1A1A40 100%);
            color: #FFFFFF;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .quiz-container, .certificate-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 24px;
            width: 90%;
            max-width: 700px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }
        .option {
            background: #2A2A4D;
            border: 2px solid #9945FF;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .option:hover {
            background: #9945FF;
            transform: translateY(-2px);
        }
        .option.correct {
            background: #14F195;
            border-color: #14F195;
            color: #0D0D2B;
        }
        .option.incorrect {
            background: #FF4A4A;
            border-color: #FF4A4A;
        }
        .btn {
            background: linear-gradient(90deg, #9945FF, #14F195);
            padding: 10px 20px;
            border-radius: 8px;
            color: #0D0D2B;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
            margin: 8px;
            text-align: center;
            width: 160px; /* Fixed width for consistent scaling */
            font-size: clamp(0.7rem, 2.5vw, 0.9rem); /* Auto-scale font */
            line-height: 1.2;
        }
        .btn:hover {
            transform: scale(1.05);
        }
        .airdrop-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 12px 20px;
            gap: 2px;
            width: 180px; /* Slightly wider for two lines */
            font-size: clamp(0.65rem, 2vw, 0.85rem); /* Smaller auto-scale for longer text */
            line-height: 1.1;
        }
        .hidden {
            display: none;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
            animation: fadeIn 0.5s ease-out;
        }
        .certificate {
            border: 4px solid #9945FF;
            background: linear-gradient(135deg, #2A2A4D, #1A1A40);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }
        .certificate h2 {
            color: #14F195;
            text-shadow: 0 0 8px rgba(20, 241, 149, 0.5);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const quizData = [
            {
                "Question": "What Solana technology enables parallel smart contract execution, boosting throughput?",
                "Correct Answer": "Sealevel",
                "Incorrect Answer 1": "Gulf Stream",
                "Incorrect Answer 2": "Turbine",
                "Funny Answer": "Degenerate Transaction Pump"
            },
            {
                "Question": "Which 2022 Solana NFT project, with 10,000 bears, aimed to create a virtuous community?",
                "Correct Answer": "Okay Bears",
                "Incorrect Answer 1": "DeGods",
                "Incorrect Answer 2": "Mad Lads",
                "Funny Answer": "Solana Snuggle Bears"
            },
            {
                "Question": "What term describes Solana traders who chase quick profits on memecoins, often on Pump.fun?",
                "Correct Answer": "Degens",
                "Incorrect Answer 1": "HODLers",
                "Incorrect Answer 2": "Whales",
                "Funny Answer": "Moon Bois"
            }
        ];

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        const QuizApp = () => {
            const [currentQuestion, setCurrentQuestion] = React.useState(0);
            const [score, setScore] = React.useState(0);
            const [selectedAnswer, setSelectedAnswer] = React.useState(null);
            const [feedback, setFeedback] = React.useState('');
            const [showFeedback, setShowFeedback] = React.useState(false);
            const [showCertificate, setShowCertificate] = React.useState(false);

            const q = quizData[currentQuestion];

            const handleAnswer = (answer) => {
                setSelectedAnswer(answer.text);
                setShowFeedback(true);
                if (answer.isCorrect) {
                    setScore(score + 1);
                    setFeedback('Correct! Nice one, degen!');
                } else {
                    setFeedback(`Incorrect! The right answer was: ${q['Correct Answer']}`);
                }
            };

            const nextQuestion = () => {
                if (currentQuestion < quizData.length - 1) {
                    setCurrentQuestion(currentQuestion + 1);
                    setSelectedAnswer(null);
                    setShowFeedback(false);
                    setFeedback('');
                } else {
                    setShowCertificate(true);
                }
            };

            const calculateIQ = () => {
                const percentCorrect = (score / quizData.length) * 100;
                const iq = Math.round(30 + (percentCorrect * (195 - 30) / 100));
                return iq;
            };

            const copyToClipboard = () => {
                const certificateElement = document.querySelector('.certificate');
                html2canvas(certificateElement).then(canvas => {
                    canvas.toBlob(blob => {
                        if (navigator.clipboard && navigator.clipboard.write) {
                            const item = new ClipboardItem({ 'image/png': blob });
                            navigator.clipboard.write([item]).then(() => {
                                alert('Certificate screenshot copied to clipboard! Paste into an image editor or chat.');
                            }).catch(() => {
                                fallbackDownload(canvas);
                            });
                        } else {
                            fallbackDownload(canvas);
                        }
                    });
                }).catch(() => {
                    alert('Failed to capture screenshot. Try running via a secure context.');
                });
            };

            const fallbackDownload = (canvas) => {
                const link = document.createElement('a');
                link.download = 'solana-iq-certificate.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
                alert('Clipboard copy not supported. Certificate downloaded as solana-iq-certificate.png.');
            };

            const tweetResults = () => {
                const iq = calculateIQ();
                const percent = ((score / quizData.length) * 100).toFixed(1);
                const tweetText = encodeURIComponent(`My Solana IQ Score is ${iq}! I got ${percent}% correct on the Solana Quiz! ðŸš€ #SolanaIQ`);
                window.open(`https://twitter.com/intent/tweet?text=${tweetText}`, '_blank');
            };

            const claimAirdrop = () => {
                window.open('https://solana-quiz-airdrop.example.com', '_blank');
            };

            const answers = [
                { text: q['Correct Answer'], isCorrect: true },
                { text: q['Incorrect Answer 1'], isCorrect: false },
                { text: q['Incorrect Answer 2'], isCorrect: false },
                { text: q['Funny Answer'], isCorrect: false }
            ];
            const shuffledAnswers = shuffle([...answers]);

            return (
                <div>
                    <div className={`quiz-container animate-fadeIn ${showCertificate ? 'hidden' : ''}`}>
                        <h1 className="text-3xl font-bold mb-6">Solana Quiz (Test)</h1>
                        <div className="progress mb-4 text-lg">
                            Question <span>{currentQuestion + 1}</span> of <span>{quizData.length}</span>
                        </div>
                        <div className="question text-xl mb-6">{q.Question}</div>
                        <div className="options flex flex-col gap-3">
                            {shuffledAnswers.map((answer, index) => (
                                <div
                                    key={index}
                                    className={`option ${selectedAnswer === answer.text ? (answer.isCorrect ? 'correct' : 'incorrect') : ''}`}
                                    onClick={() => !selectedAnswer && handleAnswer(answer)}
                                >
                                    {answer.text}
                                </div>
                            ))}
                        </div>
                        <div className={`feedback text-lg mt-4 ${showFeedback ? 'animate-fadeIn' : 'hidden'}`}>
                            {feedback}
                        </div>
                        <div className="score text-lg mt-4">Score: <span>{score}</span>/{quizData.length}</div>
                        {showFeedback && (
                            <button className="btn mt-6" onClick={nextQuestion}>
                                {currentQuestion < quizData.length - 1 ? 'Next Question' : 'See Certificate'}
                            </button>
                        )}
                    </div>
                    <div className={`certificate-container animate-fadeIn ${showCertificate ? '' : 'hidden'}`}>
                        <div className="certificate">
                            <h2 className="text-4xl font-bold mb-4">Solana IQ Certificate</h2>
                            <p className="text-xl mb-2">Congratulations, Solana Scholar!</p>
                            <p className="text-lg mb-2">Your Solana IQ Score is:</p>
                            <p className="text-5xl font-bold text-[#14F195] mb-4">{calculateIQ()}</p>
                            <p className="text-lg mb-4">
                                You answered {score} out of {quizData.length} questions correctly
                                ({((score / quizData.length) * 100).toFixed(1)}%).
                            </p>
                            <p className="text-md italic">Certified on May 17, 2025</p>
                        </div>
                        <div className="flex flex-col sm:flex-row justify-center gap-4 mt-6">
                            <button className="btn" onClick={copyToClipboard}>Copy to Clipboard</button>
                            <button className="btn" onClick={tweetResults}>Tweet Your Results</button>
                            <button className="btn airdrop-btn" onClick={claimAirdrop}>
                                <span>Paste your SOL wallet addy</span>
                                <span>You'll get $SOLANAIQ free airdrop</span>
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<QuizApp />, document.getElementById('root'));
    </script>
</body>
</html>
